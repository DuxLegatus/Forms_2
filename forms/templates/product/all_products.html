{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Products</title>
    <link rel="stylesheet" href="{% static 'css/all_products.css' %}">
</head>
<body>
    <h1>All Products</h1>

    <form method="get" class="filter-form">
        <input type="text" name="q" placeholder="Search..." value="{{ request.GET.q }}">
        <input type="text" name="category" placeholder="Category" value="{{ request.GET.category }}">
        <input type="number" name="min_price" placeholder="Min Price" value="{{ request.GET.min_price }}">
        <input type="number" name="max_price" placeholder="Max Price" value="{{ request.GET.max_price }}">
        <select name="order_by" class="order-select">
            <option value="id" {% if request.GET.order_by == "id" %}selected{% endif %}>Default</option>
            <option value="product_name" {% if request.GET.order_by == "product_name" %}selected{% endif %}>Name (A-Z)</option>
            <option value="-product_name" {% if request.GET.order_by == "-product_name" %}selected{% endif %}>Name (Z-A)</option>
            <option value="price" {% if request.GET.order_by == "price" %}selected{% endif %}>Price (Low-High)</option>
            <option value="-price" {% if request.GET.order_by == "-price" %}selected{% endif %}>Price (High-Low)</option>
        </select>
        <button type="submit" class="filter-btn">Filter</button>
    </form>

    <table>
        <tbody>
            {% for product in products %}
            <tr>
                <td>{{ product.product_name }}</td>
                <td>{{ product.price }}</td>
                <td>{{ product.product_desc }}</td>
                <td>{{ product.in_stock }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align:center;">No products found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if is_paginated %}
    <div style="text-align:center; margin-top:20px;">
        {% if page_obj.has_previous %}
            <a href="?{{ query_params }}&page={{ page_obj.previous_page_number }}">Previous</a>
        {% endif %}

        <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
            <a href="?{{ query_params }}&page={{ page_obj.next_page_number }}">Next</a>
        {% endif %}
    </div>
    {% endif %}
</body>
</html>